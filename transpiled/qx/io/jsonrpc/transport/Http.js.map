{
  "version": 3,
  "sources": [
    "/home/runner/work/incubator.qx.io.jsonrpc/incubator.qx.io.jsonrpc/source/class/qx/io/jsonrpc/transport/Http.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "io",
    "jsonrpc",
    "transport",
    "Abstract",
    "implement",
    "ITransport",
    "construct",
    "url",
    "_tranportImpl",
    "_createTransportImpl",
    "members",
    "getTransportImpl",
    "send",
    "message",
    "assertString",
    "req",
    "setRequestData",
    "sendWithPromise",
    "e",
    "type",
    "BaseError",
    "getComment",
    "exception",
    "Transport",
    "toString",
    "TIMEOUT",
    "INVALID_MSG_DATA",
    "Cancel",
    "FAILED",
    "fireDataEvent",
    "getResponse",
    "request",
    "Xhr",
    "getEndpoint",
    "setAccept",
    "setCache",
    "setRequestHeader",
    "setParser",
    "response",
    "defer",
    "Client",
    "registerTransport",
    "Http"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * The implementation of a JSON-RPC transport for JSON-RPC via HTTP\n *\n * The HTTP transport implementation is based on the {@link qx.io.request} API,\n * so any special configuration of the HTTP request must be done on the\n * underlying implementation of {@link qx.io.request.AbstractRequest}.\n *\n * More abstract support for authentication will be added later.\n *\n */\nqx.Class.define(\"qx.io.jsonrpc.transport.Http\", {\n  extend: qx.io.jsonrpc.transport.Abstract,\n  implement : qx.io.jsonrpc.transport.ITransport,\n\n  /**\n   * Constructor.\n   *\n   * @param {String} url The URL of the http endpoint\n   */\n  construct(url) {\n    this.base(arguments, url);\n    this._tranportImpl = this._createTransportImpl();\n  },\n\n  members: {\n\n    /**\n     * Internal implementation of the transport\n     * @var {qx.io.request.Xhr}\n     */\n    _tranportImpl : null,\n\n    /**\n     * Returns the object which implements the transport on the underlying\n     * level, so that transport-specific configuration can be done on it.\n     * @return {qx.core.Object}\n     */\n    getTransportImpl() {\n      return this._tranportImpl;\n    },\n\n    /**\n     * Transport the given message to the endpoint\n     *\n     * @param {String} message\n     *\n     * @return {qx.Promise} Promise that resolves (with no data)\n     * when the message has been successfully sent out, and rejects\n     * when there is an error or a cancellation up to that point.\n     */\n    async send(message) {\n      this.assertString(message);\n      const req = this._tranportImpl;\n      req.setRequestData(message);\n      try {\n        await req.sendWithPromise();\n      } catch(e) {\n        if (e instanceof qx.type.BaseError) {\n          switch (e.getComment()) {\n            case \"timeout\":\n              throw new qx.io.jsonrpc.exception.Transport(\n                e.toString(),\n                qx.io.jsonrpc.exception.Transport.TIMEOUT,\n                {message}\n              );\n            case \"parseError\":\n              throw new qx.io.jsonrpc.exception.Transport(\n                e.toString(),\n                qx.io.jsonrpc.exception.Transport.INVALID_MSG_DATA,\n                {message}\n              );\n            case \"abort\":\n              throw new qx.io.jsonrpc.exception.Cancel(\n                e.toString(),\n                {message}\n              );\n            case \"statusError\":\n            case \"error\":\n              throw new qx.io.jsonrpc.exception.Transport(\n                e.toString(),\n                qx.io.jsonrpc.exception.Transport.FAILED,\n                {message}\n              );\n          }\n        }\n      }\n      // handle responses\n      this.fireDataEvent(\"message\", req.getResponse());\n    },\n\n    /**\n     * Factory method to create a request object. By default, a POST\n     * request will be made, and the expected response type will be\n     * \"application/json\", but differently to the standard behavior,\n     * the response will not be parsed into a javascript object.\n     *\n     * Classes extending this one may override this\n     * method to obtain a Request object with different\n     * parameters and/or different authentication settings.\n     *\n     * @return {qx.io.jsonrpc.Request}\n     */\n    _createTransportImpl: function() {\n      const req =  new qx.io.request.Xhr(this.getEndpoint(),\"POST\");\n      req.setAccept(\"application/json\");\n      req.setCache(false);\n      req.setRequestHeader(\"content-type\", \"application/json\");\n      // disable parsing, we are going to parse the JSON ourselves\n      req.setParser(response => response);\n      return req;\n    }\n  },\n\n  defer() {\n    qx.io.jsonrpc.Client.registerTransport(/^http/, qx.io.jsonrpc.transport.Http);\n  }\n});\n"
  ]
}