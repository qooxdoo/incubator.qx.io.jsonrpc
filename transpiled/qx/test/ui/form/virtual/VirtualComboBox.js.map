{
  "version": 3,
  "sources": [
    "/home/runner/work/incubator.qx.io.jsonrpc/incubator.qx.io.jsonrpc/node_modules/@qooxdoo/compiler/node_modules/@qooxdoo/framework/source/class/qx/test/ui/form/virtual/VirtualComboBox.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "test",
    "ui",
    "LayoutTestCase",
    "members",
    "__comboBox",
    "__model",
    "setUp",
    "form",
    "VirtualComboBox",
    "getRoot",
    "add",
    "flush",
    "tearDown",
    "destroy",
    "dispose",
    "__createSimpleModel",
    "model",
    "data",
    "Array",
    "i",
    "push",
    "__createRichModel",
    "__createNestedModel",
    "rawData",
    "firstname",
    "lastname",
    "marshal",
    "Json",
    "createModel",
    "testPreselectOnOpen",
    "setModel",
    "setValue",
    "open",
    "close",
    "assertNotEquals",
    "getValue",
    "assertEquals",
    "testSelectFirstMatch",
    "preselected",
    "getChildControl",
    "_preselected",
    "testSelectFirstMatchWithSortedModel",
    "delegate",
    "sorter",
    "a",
    "b",
    "setDelegate",
    "that",
    "window",
    "setTimeout",
    "resume",
    "wait",
    "testSelectFirstMatchWithFilteredModel",
    "filter",
    "item",
    "num",
    "parseInt",
    "exec",
    "assertNull",
    "testSelectFirstMatchWithFormatter",
    "configureItem",
    "setRich",
    "setDefaultFormat",
    "lang",
    "String",
    "stripTags",
    "bom",
    "unescape",
    "testSelectFirstMatchByLabelPath",
    "setLabelPath",
    "getLastname",
    "testEmptySelection",
    "label",
    "selection",
    "getSelection",
    "getModel",
    "getItem",
    "removeAll",
    "testOpenWithUnrenderedWidget",
    "cb",
    "virtual"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;AAAAA,EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;AAAA;;;;;;;;;;;;;;AAeAH,EAAAA,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,yCAAhB,EACA;AAEEC,IAAAA,MAAM,EAAGN,EAAE,CAACO,IAAH,CAAQC,EAAR,CAAWC,cAFtB;AAIEC,IAAAA,OAAO,EACP;AACEC,MAAAA,mBAAU,EAAG,IADf;AAEEC,MAAAA,gBAAO,EAAG,IAFZ;AAKEC,MAAAA,KAAK,EAAG,iBACR;AACE;AACA,aAAKF,mBAAL,GAAkB,IAAIX,EAAE,CAACQ,EAAH,CAAMM,IAAN,CAAWC,eAAf,EAAlB;AACA,aAAKC,OAAL,GAAeC,GAAf,CAAmB,KAAKN,mBAAxB;AAEA,aAAKO,KAAL;AACD,OAZH;AAcEC,MAAAA,QAAQ,EAAG,oBACX;AACE;;AACA,aAAKR,mBAAL,CAAgBS,OAAhB;;AACA,aAAKT,mBAAL,GAAkB,IAAlB;;AACA,aAAKC,gBAAL,CAAaS,OAAb;;AACA,aAAKH,KAAL;AACD,OArBH;AAuBEI,MAAAA,4BAAmB,EAAG,wCACtB;AACE,YAAIC,KAAK,GAAG,IAAIvB,EAAE,CAACwB,IAAH,CAAQC,KAAZ,EAAZ;;AAEA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,GAApB,EAAyBA,CAAC,EAA1B,EAA8B;AAC5BH,UAAAA,KAAK,CAACI,IAAN,CAAW,WAAWD,CAAC,GAAG,CAAf,CAAX;AACD;;AAED,eAAOH,KAAP;AACD,OAhCH;AAkCEK,MAAAA,0BAAiB,EAAG,sCACpB;AACE,YAAIL,KAAK,GAAG,IAAIvB,EAAE,CAACwB,IAAH,CAAQC,KAAZ,EAAZ;;AAEA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,GAApB,EAAyBA,CAAC,EAA1B,EAA8B;AAC5BH,UAAAA,KAAK,CAACI,IAAN,CAAW,cAAcD,CAAC,GAAG,CAAlB,IAAuB,MAAlC;AACD;;AAED,eAAOH,KAAP;AACD,OA3CH;AA6CEM,MAAAA,4BAAmB,EAAG,wCACtB;AACE,YAAIC,OAAO,GAAG,CACZ;AACEC,UAAAA,SAAS,EAAG,OADd;AAEEC,UAAAA,QAAQ,EAAG;AAFb,SADY,EAKZ;AACED,UAAAA,SAAS,EAAG,UADd;AAEEC,UAAAA,QAAQ,EAAG;AAFb,SALY,EASZ;AACED,UAAAA,SAAS,EAAG,UADd;AAEEC,UAAAA,QAAQ,EAAG;AAFb,SATY,CAAd;AAcA,YAAIT,KAAK,GAAGvB,EAAE,CAACwB,IAAH,CAAQS,OAAR,CAAgBC,IAAhB,CAAqBC,WAArB,CAAiCL,OAAjC,CAAZ;AACA,eAAOP,KAAP;AACD,OA/DH;AAiEEa,MAAAA,mBAAmB,EAAG,+BACtB;AACE,aAAKxB,gBAAL,GAAe,KAAKU,4BAAL,EAAf;;AACA,aAAKX,mBAAL,CAAgB0B,QAAhB,CAAyB,KAAKzB,gBAA9B;;AACA,aAAKD,mBAAL,CAAgB2B,QAAhB,CAAyB,GAAzB;;AACA,aAAKpB,KAAL;;AACA,aAAKP,mBAAL,CAAgB4B,IAAhB;;AACA,aAAKrB,KAAL;;AACA,aAAKP,mBAAL,CAAgB6B,KAAhB;;AACA,aAAKtB,KAAL,GARF,CASE;;AACA,aAAKuB,eAAL,CAAqB,QAArB,EAA+B,KAAK9B,mBAAL,CAAgB+B,QAAhB,EAA/B;AACA,aAAKC,YAAL,CAAkB,GAAlB,EAAuB,KAAKhC,mBAAL,CAAgB+B,QAAhB,EAAvB;AACD,OA9EH;AAgFEE,MAAAA,oBAAoB,EAAG,gCACvB;AACE,aAAKhC,gBAAL,GAAe,KAAKU,4BAAL,EAAf;;AACA,aAAKX,mBAAL,CAAgB0B,QAAhB,CAAyB,KAAKzB,gBAA9B;;AACA,aAAKD,mBAAL,CAAgB2B,QAAhB,CAAyB,QAAzB;;AACA,aAAKpB,KAAL;;AACA,aAAKP,mBAAL,CAAgB4B,IAAhB;;AACA,aAAKrB,KAAL;;AACA,YAAI2B,WAAW,GAAG,KAAKlC,mBAAL,CAAgBmC,eAAhB,CAAgC,UAAhC,EAA4CC,YAA9D;;AACA,aAAKJ,YAAL,CAAkB,QAAlB,EAA4BE,WAA5B;AACA,aAAKF,YAAL,CAAkB,QAAlB,EAA4B,KAAKhC,mBAAL,CAAgB+B,QAAhB,EAA5B;AACD,OA3FH;AA6FEM,MAAAA,mCAAmC,EAAG,+CACtC;AACE,aAAKpC,gBAAL,GAAe,KAAKU,4BAAL,EAAf;;AACA,aAAKX,mBAAL,CAAgB0B,QAAhB,CAAyB,KAAKzB,gBAA9B;;AACA,YAAIqC,QAAQ,GAAG;AACb;AACAC,UAAAA,MAAM,EAAG,gBAASC,CAAT,EAAYC,CAAZ,EAAe;AACtB,mBAAOD,CAAC,GAAGC,CAAJ,GAAQ,CAAR,GAAYD,CAAC,GAAGC,CAAJ,GAAQ,CAAC,CAAT,GAAa,CAAhC;AACD;AAJY,SAAf;;AAMA,aAAKzC,mBAAL,CAAgB0C,WAAhB,CAA4BJ,QAA5B;;AACA,aAAKtC,mBAAL,CAAgB2B,QAAhB,CAAyB,QAAzB;;AACA,aAAKpB,KAAL;;AACA,aAAKP,mBAAL,CAAgB4B,IAAhB;;AACA,aAAKrB,KAAL;;AACA,YAAI2B,WAAW,GAAG,KAAKlC,mBAAL,CAAgBmC,eAAhB,CAAgC,UAAhC,EAA4CC,YAA9D;;AACA,aAAKJ,YAAL,CAAkB,SAAlB,EAA6BE,WAA7B;AACA,aAAKF,YAAL,CAAkB,QAAlB,EAA4B,KAAKhC,mBAAL,CAAgB+B,QAAhB,EAA5B,EAhBF,CAkBE;AACA;AACA;AACA;AACA;;AACA,YAAIY,IAAI,GAAG,IAAX;AACAC,QAAAA,MAAM,CAACC,UAAP,CAAkB,YAAW;AAC3BF,UAAAA,IAAI,CAACG,MAAL;AACD,SAFD,EAEG,GAFH;AAGA,aAAKC,IAAL,CAAU,GAAV;AACD,OA1HH;AA4HEC,MAAAA,qCAAqC,EAAG,iDACxC;AACE,aAAK/C,gBAAL,GAAe,KAAKU,4BAAL,EAAf;;AACA,aAAKX,mBAAL,CAAgB0B,QAAhB,CAAyB,KAAKzB,gBAA9B;;AACA,YAAIqC,QAAQ,GAAG;AACb;AACAW,UAAAA,MAAM,EAAG,gBAASC,IAAT,EAAe;AACtB,gBAAIC,GAAG,GAAGC,QAAQ,CAAC,WAAWC,IAAX,CAAgBH,IAAhB,EAAsB,CAAtB,CAAD,EAA2B,EAA3B,CAAlB;AACA,mBAAOC,GAAG,GAAG,CAAN,GAAU,IAAV,GAAiB,KAAxB;AACD;AALY,SAAf;;AAOA,aAAKnD,mBAAL,CAAgB0C,WAAhB,CAA4BJ,QAA5B;;AACA,aAAKtC,mBAAL,CAAgB2B,QAAhB,CAAyB,SAAzB;;AACA,aAAKpB,KAAL;;AACA,aAAKP,mBAAL,CAAgB4B,IAAhB;;AACA,aAAKrB,KAAL,GAdF,CAeE;;AACA,YAAI2B,WAAW,GAAG,KAAKlC,mBAAL,CAAgBmC,eAAhB,CAAgC,UAAhC,EAA4CC,YAA9D;;AACA,aAAKkB,UAAL,CAAgBpB,WAAhB;AACA,aAAKF,YAAL,CAAkB,SAAlB,EAA6B,KAAKhC,mBAAL,CAAgB+B,QAAhB,EAA7B;AACD,OAhJH;AAkJEwB,MAAAA,iCAAiC,EAAG,6CACpC;AACE,aAAKtD,gBAAL,GAAe,KAAKgB,0BAAL,EAAf;;AACA,aAAKjB,mBAAL,CAAgB0B,QAAhB,CAAyB,KAAKzB,gBAA9B;;AACA,YAAIqC,QAAQ,GAAG;AACbkB,UAAAA,aAAa,EAAG,uBAASN,IAAT,EAChB;AACEA,YAAAA,IAAI,CAACO,OAAL,CAAa,IAAb;AACD;AAJY,SAAf;;AAMA,aAAKzD,mBAAL,CAAgB0C,WAAhB,CAA4BJ,QAA5B;;AACA,aAAKtC,mBAAL,CAAgB0D,gBAAhB,CAAiC,UAAS7C,IAAT,EAAe;AAC9C,cAAIA,IAAJ,EAAU;AACRA,YAAAA,IAAI,GAAGxB,EAAE,CAACsE,IAAH,CAAQC,MAAR,CAAeC,SAAf,CAAyBhD,IAAzB,CAAP;AACAA,YAAAA,IAAI,GAAGxB,EAAE,CAACyE,GAAH,CAAOF,MAAP,CAAcG,QAAd,CAAuBlD,IAAvB,CAAP;AACD;;AACD,iBAAOA,IAAP;AACD,SAND;;AAOA,aAAKb,mBAAL,CAAgB2B,QAAhB,CAAyB,QAAzB;;AACA,aAAKpB,KAAL;;AACA,aAAKP,mBAAL,CAAgB4B,IAAhB;;AACA,aAAKrB,KAAL;;AACA,YAAI2B,WAAW,GAAG,KAAKlC,mBAAL,CAAgBmC,eAAhB,CAAgC,UAAhC,EAA4CC,YAA9D;;AACA,aAAKJ,YAAL,CAAkB,eAAlB,EAAmCE,WAAnC;AACA,aAAKF,YAAL,CAAkB,QAAlB,EAA4B,KAAKhC,mBAAL,CAAgB+B,QAAhB,EAA5B;AACD,OA3KH;AA6KEiC,MAAAA,+BAA+B,EAAG,2CAClC;AACE,aAAK/D,gBAAL,GAAe,KAAKiB,4BAAL,EAAf;;AACA,aAAKlB,mBAAL,CAAgBiE,YAAhB,CAA6B,UAA7B;;AACA,aAAKjE,mBAAL,CAAgB0B,QAAhB,CAAyB,KAAKzB,gBAA9B;;AACA,aAAKD,mBAAL,CAAgB2B,QAAhB,CAAyB,IAAzB;;AACA,aAAKpB,KAAL;;AACA,aAAKP,mBAAL,CAAgB4B,IAAhB;;AACA,aAAKrB,KAAL;;AACA,YAAI2B,WAAW,GAAG,KAAKlC,mBAAL,CAAgBmC,eAAhB,CAAgC,UAAhC,EAA4CC,YAA5C,CAAyD8B,WAAzD,EAAlB;;AACA,aAAKlC,YAAL,CAAkB,OAAlB,EAA2BE,WAA3B;AACA,aAAKF,YAAL,CAAkB,IAAlB,EAAwB,KAAKhC,mBAAL,CAAgB+B,QAAhB,EAAxB;AACD,OAzLH;AA2LEoC,MAAAA,kBAAkB,EAAG,8BACrB;AACE,aAAKnE,mBAAL,CAAgBiE,YAAhB,CAA6B,OAA7B;;AACA,YAAI9C,OAAO,GAAG,CAAC;AACbiD,UAAAA,KAAK,EAAG;AADK,SAAD,CAAd;AAGA,YAAIxD,KAAK,GAAG,KAAKX,gBAAL,GAAeZ,EAAE,CAACwB,IAAH,CAAQS,OAAR,CAAgBC,IAAhB,CAAqBC,WAArB,CAAiCL,OAAjC,CAA3B;;AACA,aAAKnB,mBAAL,CAAgB0B,QAAhB,CAAyBd,KAAzB;;AACA,YAAIyD,SAAS,GAAG,KAAKrE,mBAAL,CAAgBmC,eAAhB,CAAgC,UAAhC,EAA4CmC,YAA5C,EAAhB;;AACAD,QAAAA,SAAS,CAACrD,IAAV,CAAe,KAAKhB,mBAAL,CAAgBuE,QAAhB,GAA2BC,OAA3B,CAAmC,CAAnC,CAAf;AACAH,QAAAA,SAAS,CAACI,SAAV;AACD,OAtMH;AAwMEC,MAAAA,4BAA4B,EAAG,wCAC/B;AACE,YAAIC,EAAE,GAAG,IAAItF,EAAE,CAACQ,EAAH,CAAMM,IAAN,CAAWC,eAAf,EAAT;AACAuE,QAAAA,EAAE,CAAC/C,IAAH;AACA,aAAKvB,OAAL,GAAeC,GAAf,CAAmBqE,EAAnB;AACD;AA7MH;AALF,GADA;AAfAtF,EAAAA,EAAE,CAACO,IAAH,CAAQC,EAAR,CAAWM,IAAX,CAAgByE,OAAhB,CAAwBxE,eAAxB,CAAwCZ,aAAxC,GAAwDA,aAAxD",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2011 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n************************************************************************ */\n\nqx.Class.define(\"qx.test.ui.form.virtual.VirtualComboBox\",\n{\n\n  extend : qx.test.ui.LayoutTestCase,\n\n  members :\n  {\n    __comboBox : null,\n    __model : null,\n\n\n    setUp : function()\n    {\n      this.base(arguments);\n      this.__comboBox = new qx.ui.form.VirtualComboBox();\n      this.getRoot().add(this.__comboBox);\n\n      this.flush();\n    },\n\n    tearDown : function()\n    {\n      this.base(arguments);\n      this.__comboBox.destroy();\n      this.__comboBox = null;\n      this.__model.dispose();\n      this.flush();\n    },\n\n    __createSimpleModel : function()\n    {\n      var model = new qx.data.Array();\n\n      for (var i = 0; i < 100; i++) {\n        model.push(\"item \" + (i + 1));\n      }\n\n      return model;\n    },\n\n    __createRichModel : function()\n    {\n      var model = new qx.data.Array();\n\n      for (var i = 0; i < 100; i++) {\n        model.push(\"<b>item \" + (i + 1) + \"</b>\");\n      }\n\n      return model;\n    },\n\n    __createNestedModel : function()\n    {\n      var rawData = [\n        {\n          firstname : \"James\",\n          lastname : \"Kirk\"\n        },\n        {\n          firstname : \"Jean-Luc\",\n          lastname : \"Picard\"\n        },\n        {\n          firstname : \"Benjamin\",\n          lastname : \"Sisko\"\n        }\n      ];\n      var model = qx.data.marshal.Json.createModel(rawData);\n      return model;\n    },\n\n    testPreselectOnOpen : function()\n    {\n      this.__model = this.__createSimpleModel();\n      this.__comboBox.setModel(this.__model);\n      this.__comboBox.setValue(\"i\");\n      this.flush();\n      this.__comboBox.open();\n      this.flush();\n      this.__comboBox.close();\n      this.flush();\n      // Preselection may not change the actual value\n      this.assertNotEquals(\"item 1\", this.__comboBox.getValue());\n      this.assertEquals(\"i\", this.__comboBox.getValue());\n    },\n\n    testSelectFirstMatch : function()\n    {\n      this.__model = this.__createSimpleModel();\n      this.__comboBox.setModel(this.__model);\n      this.__comboBox.setValue(\"item 4\");\n      this.flush();\n      this.__comboBox.open();\n      this.flush();\n      var preselected = this.__comboBox.getChildControl(\"dropdown\")._preselected;\n      this.assertEquals(\"item 4\", preselected);\n      this.assertEquals(\"item 4\", this.__comboBox.getValue());\n    },\n\n    testSelectFirstMatchWithSortedModel : function()\n    {\n      this.__model = this.__createSimpleModel();\n      this.__comboBox.setModel(this.__model);\n      var delegate = {\n        // invert sort order\n        sorter : function(a, b) {\n          return a < b ? 1 : a > b ? -1 : 0;\n        }\n      };\n      this.__comboBox.setDelegate(delegate);\n      this.__comboBox.setValue(\"item 4\");\n      this.flush();\n      this.__comboBox.open();\n      this.flush();\n      var preselected = this.__comboBox.getChildControl(\"dropdown\")._preselected;\n      this.assertEquals(\"item 49\", preselected);\n      this.assertEquals(\"item 4\", this.__comboBox.getValue());\n\n      // The virtual list uses a timeout to asynchronously flush the layout\n      // queue and scroll the (pre)selected item into view. tearDown is called\n      // before this timer's callback so the list container tries to scroll a\n      // disposed widget which causes an exception. To get around this, we use\n      // a timeout to delay the tearDown call.\n      var that = this;\n      window.setTimeout(function() {\n        that.resume();\n      }, 100);\n      this.wait(200);\n    },\n\n    testSelectFirstMatchWithFilteredModel : function()\n    {\n      this.__model = this.__createSimpleModel();\n      this.__comboBox.setModel(this.__model);\n      var delegate = {\n        // remove even-numbered items\n        filter : function(item) {\n          var num = parseInt(/([0-9]+)/.exec(item)[1], 10);\n          return num % 2 ? true : false;\n        }\n      };\n      this.__comboBox.setDelegate(delegate);\n      this.__comboBox.setValue(\"item 22\");\n      this.flush();\n      this.__comboBox.open();\n      this.flush();\n      // item 22 is not in the list, nothing should be preselected\n      var preselected = this.__comboBox.getChildControl(\"dropdown\")._preselected;\n      this.assertNull(preselected);\n      this.assertEquals(\"item 22\", this.__comboBox.getValue());\n    },\n\n    testSelectFirstMatchWithFormatter : function()\n    {\n      this.__model = this.__createRichModel();\n      this.__comboBox.setModel(this.__model);\n      var delegate = {\n        configureItem : function(item)\n        {\n          item.setRich(true);\n        }\n      };\n      this.__comboBox.setDelegate(delegate);\n      this.__comboBox.setDefaultFormat(function(data) {\n        if (data) {\n          data = qx.lang.String.stripTags(data);\n          data = qx.bom.String.unescape(data);\n        }\n        return data;\n      });\n      this.__comboBox.setValue(\"item 4\");\n      this.flush();\n      this.__comboBox.open();\n      this.flush();\n      var preselected = this.__comboBox.getChildControl(\"dropdown\")._preselected;\n      this.assertEquals(\"<b>item 4</b>\", preselected);\n      this.assertEquals(\"item 4\", this.__comboBox.getValue());\n    },\n\n    testSelectFirstMatchByLabelPath : function()\n    {\n      this.__model = this.__createNestedModel();\n      this.__comboBox.setLabelPath(\"lastname\");\n      this.__comboBox.setModel(this.__model);\n      this.__comboBox.setValue(\"Si\");\n      this.flush();\n      this.__comboBox.open();\n      this.flush();\n      var preselected = this.__comboBox.getChildControl(\"dropdown\")._preselected.getLastname();\n      this.assertEquals(\"Sisko\", preselected);\n      this.assertEquals(\"Si\", this.__comboBox.getValue());\n    },\n\n    testEmptySelection : function()\n    {\n      this.__comboBox.setLabelPath(\"label\");\n      var rawData = [{\n        label : \"foo\"\n      }];\n      var model = this.__model = qx.data.marshal.Json.createModel(rawData);\n      this.__comboBox.setModel(model);\n      var selection = this.__comboBox.getChildControl(\"dropdown\").getSelection();\n      selection.push(this.__comboBox.getModel().getItem(0));\n      selection.removeAll();\n    },\n\n    testOpenWithUnrenderedWidget : function()\n    {\n      var cb = new qx.ui.form.VirtualComboBox();\n      cb.open();\n      this.getRoot().add(cb);\n    }\n  }\n\n});\n"
  ]
}